<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Trakt → Radarr/Sonarr Quick Add — Settings</title>
  <style>
    :root{
      color-scheme: dark;
      --bg0:#0b0d12;
      --bg1:#0f1320;
      --card: rgba(255,255,255,.06);
      --border: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --muted2: rgba(255,255,255,.56);
      --ok: rgba(110,240,160,1);
      --bad: rgba(255,140,140,1);
      --accent: 220 95% 60%;
      --accent2: 160 88% 52%;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 18px;
    }
    *{ box-sizing: border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans", Arial, sans-serif;
      background:
        radial-gradient(1200px 900px at 10% -10%, hsla(var(--accent), .28), transparent 55%),
        radial-gradient(900px 700px at 110% 10%, hsla(var(--accent2), .18), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      color: var(--text);
    }
    .wrap{ max-width: 1080px; margin: 0 auto; padding: 22px 16px 34px; }
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom:14px;
      animation: fadeIn .35s ease-out both;
    }
    .brand{ display:flex; align-items:center; gap:10px; }
    .logo{
      width:38px; height:38px; border-radius: 14px;
      background:
        radial-gradient(18px 18px at 30% 30%, hsla(var(--accent), .85), transparent 60%),
        radial-gradient(18px 18px at 70% 70%, hsla(var(--accent2), .75), transparent 60%),
        rgba(255,255,255,.06);
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      display:grid; place-items:center;
    }
    h1{ font-size: 16px; margin:0; letter-spacing:.2px; }
    .subtitle{ font-size: 12px; color: var(--muted); margin-top:4px; }
    .title{ display:flex; flex-direction:column; line-height:1.1; }
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      animation: fadeIn .42s ease-out both;
    }
    .section{
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: calc(var(--radius) - 2px);
      padding: 14px;
      margin-top: 14px;
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
    }
    .section:hover{
      transform: translateY(-1px);
      background: rgba(0,0,0,.22);
      border-color: rgba(255,255,255,.14);
    }
    .sec-head{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom: 10px;
    }
    .sec-left{ display:flex; align-items:center; gap:10px; }
    .ico{
      width:34px; height:34px; border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      display:grid; place-items:center;
    }
    .ico svg{ width:18px; height:18px; opacity:.9; }
    .sec-title{ font-size: 13px; font-weight: 800; letter-spacing:.2px; display:flex; align-items:center; gap:10px; }
    .pill{
      font-size: 12px; padding: 2px 10px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.16); color: var(--muted);
      background: rgba(255,255,255,.04);
      white-space: nowrap;
    }
    .muted{ color: var(--muted); font-size: 12px; line-height: 1.35; }
    .muted2{ color: var(--muted2); font-size: 12px; line-height: 1.35; }
    .grid{ display:grid; gap:12px; grid-template-columns: 1fr 1fr; }
    .grid3{ display:grid; gap:12px; grid-template-columns: 1fr 1fr 1fr; }
    @media (max-width: 920px){
      .grid, .grid3{ grid-template-columns: 1fr; }
    }
    label{ display:block; font-size: 12px; color: var(--muted); margin: 0 0 6px; }
    input, select{
      width:100%;
      padding:10px 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      color: var(--text);
      outline:none;
      transition: border-color .16s ease, background .16s ease;
    }
    input:focus, select:focus{
      border-color: hsla(var(--accent), .55);
      background: rgba(0,0,0,.32);
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    button{
      border-radius: 14px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.18);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      color: var(--text);
      cursor:pointer;
      font-weight: 800;
      transition: transform .16s ease, border-color .16s ease;
    }
    button:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.26); }
    button:active{ transform: translateY(0px) scale(.99); }
    button.small{ padding: 8px 10px; border-radius: 12px; font-weight: 800; }
    button.primary{
      border-color: hsla(var(--accent), .45);
      background:
        radial-gradient(120px 80px at 20% 10%, hsla(var(--accent), .35), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
    }
    .status{
      font-size: 12px; padding: 2px 10px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      transition: border-color .18s ease, color .18s ease;
    }
    .status.ok{ color: var(--ok); border-color: rgba(110,240,160,.35); animation: pulseOk 1.1s ease-out 1; }
    .status.bad{ color: var(--bad); border-color: rgba(255,140,140,.35); }
    .hint{
      border:1px dashed rgba(255,255,255,.18);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(0,0,0,.22);
      font-size: 12px;
      color: var(--muted);
      line-height: 1.35;
    }
    .sep{ height:1px; background: rgba(255,255,255,.10); margin: 14px 0; }
    .footer{
      margin-top: 14px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      color: var(--muted2);
      font-size: 12px;
    }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
    @keyframes fadeIn{ from{ opacity:0; transform: translateY(8px);} to{ opacity:1; transform: translateY(0);} }
    @keyframes pulseOk{ 0%{ box-shadow: 0 0 0 rgba(110,240,160,0); } 30%{ box-shadow: 0 0 0 6px rgba(110,240,160,.10); } 100%{ box-shadow: 0 0 0 rgba(110,240,160,0); } }
 
    .primary{ position:relative; overflow:hidden; }
    .primary::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(500px 300px at 20% 20%, rgba(255,255,255,.18), transparent 55%);
      opacity:.65;
      pointer-events:none;
      transform: translateY(-8px);
    }
    button.small{ display:inline-flex; align-items:center; gap:8px; }
    button.small svg{ width:16px; height:16px; opacity:.9; }

    .subtitle{ display:flex; align-items:center; gap:10px; }
    .subtitle svg.gear{ width:16px; height:16px; opacity:.9; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logoimg" aria-hidden="true"><img src="icons/header.png" alt=""/></div>
        <div class="title">
          <h1>Trakt → Radarr/Sonarr Quick Add</h1>
          <div class="subtitle"><svg class="gear" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 15.2a3.2 3.2 0 1 0 0-6.4 3.2 3.2 0 0 0 0 6.4Z" stroke="rgba(255,255,255,.85)" stroke-width="1.8"/><path d="M19.4 12a7.5 7.5 0 0 0-.1-1l2-1.5-2-3.4-2.4 1a7.8 7.8 0 0 0-1.7-1l-.4-2.6H9.2l-.4 2.6a7.8 7.8 0 0 0-1.7 1l-2.4-1-2 3.4 2 1.5a7.5 7.5 0 0 0 0 2l-2 1.5 2 3.4 2.4-1a7.8 7.8 0 0 0 1.7 1l.4 2.6h5.6l.4-2.6a7.8 7.8 0 0 0 1.7-1l2.4 1 2-3.4-2-1.5c.1-.3.1-.6.1-1Z" stroke="rgba(255,255,255,.55)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg><span>Settings</span></div>
        </div>
      </div>
      <div class="row">
        <button id="save" class="primary"><span>Save</span></button>
        <span id="saveStatus" class="muted2"></span>
      </div>
    </div>

    <div class="card">
      <div class="muted">
        Radarr/Sonarr: press <b>Test</b>. If the connection succeeds, the extension will automatically fetch folders/profiles for you.
      </div>

      <!-- Radarr -->
      <div class="section">
        <div class="sec-head">
          <div class="sec-left">
              <div class="ico radarr" aria-hidden="true"><img src="icons/Radarr.png" alt=""/></div>
            <div class="sec-title">Radarr</div>
          </div>
          <span id="radarrStatus" class="status">—</span>
        </div>

        <div class="grid3">
          <div>
            <label>Base URL</label>
            <input id="radarrUrl" placeholder="http://localhost:7878"/>
          </div>
          <div>
            <label>API Key</label>
            <input id="radarrKey" placeholder="X-Api-Key"/>
          </div>
          <div class="row" style="align-items:flex-end">
            <button id="radarrTest" class="small"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 7 10.5 16.5 4 10" stroke="rgba(255,255,255,.9)" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg><span>Test</span></button>
          </div>
        </div>

        <div class="grid3" style="margin-top:12px">
          <div>
            <label>Root Folder</label>
            <select id="radarrRoot"></select>
          </div>
          <div>
            <label>Quality Profile</label>
            <select id="radarrProfile"></select>
          </div>
          <div>
            <label>Search on Add</label>
            <select id="radarrSearch">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Sonarr -->
      <div class="section">
        <div class="sec-head">
          <div class="sec-left">
             <div class="ico sonarr" aria-hidden="true"><img src="icons/Sonarr.png" alt=""/></div>
            <div class="sec-title">Sonarr</div>
          </div>
          <span id="sonarrStatus" class="status">—</span>
        </div>

        <div class="grid3">
          <div>
            <label>Base URL</label>
            <input id="sonarrUrl" placeholder="http://localhost:8989"/>
          </div>
          <div>
            <label>API Key</label>
            <input id="sonarrKey" placeholder="X-Api-Key"/>
          </div>
          <div class="row" style="align-items:flex-end">
            <button id="sonarrTest" class="small"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 7 10.5 16.5 4 10" stroke="rgba(255,255,255,.9)" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg><span>Test</span></button>
          </div>
        </div>

        <div class="grid3" style="margin-top:12px">
          <div>
            <label>Root Folder</label>
            <select id="sonarrRoot"></select>
          </div>
          <div>
            <label>Quality Profile</label>
            <select id="sonarrProfile"></select>
          </div>
          <div>
            <label>Language Profile (optional)</label>
            <select id="sonarrLang"></select>
          </div>
        </div>

        <div class="grid3" style="margin-top:12px">
          <div>
            <label>Season Folder</label>
            <select id="sonarrSeasonFolder">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div>
            <label>Search on Add</label>
            <select id="sonarrSearch">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div class="muted2">
            Sonarr prefers TVDb IDs when available (best accuracy).
          </div>
        </div>
      </div>

      <!-- Trakt optional -->
      <div class="section">
        <div class="sec-head">
          <div class="sec-left">
             <div class="ico trakt" aria-hidden="true"><img src="icons/Trakt.png" alt=""/></div>
            <div class="sec-title">Trakt <span class="pill">optional</span></div>
          </div>
          <span id="traktAuthStatus" class="status">—</span>
        </div>

        <div class="muted">
          Not required for Radarr/Sonarr add. Enable only if you want: (1) Trakt API ID fallback, and/or (2) auto-add to a Trakt list for review.
        </div>

        <div class="sep"></div>

        <div class="grid">
          <div>
            <label>Trakt Client ID <span class="pill">fallback</span></label>
            <input id="traktClientId" placeholder="Optional: used to fetch IDs via Trakt API if page IDs are missing"/>
            <div class="muted2" style="margin-top:6px">
              Used as a fallback to resolve IDs (TMDb/TVDb/IMDb) when Trakt pages don't expose them.
            </div>
          </div>
          <div>
            <label>Trakt Client Secret <span class="pill">only for list auto-add</span></label>
            <input id="traktClientSecret" placeholder="Required only if you enable auto-add to list"/>
            <div class="muted2" style="margin-top:6px">
              Needed for OAuth to add items into your Trakt lists.
            </div>
          </div>
        </div>

        <div class="hint" style="margin-top:12px">
          <b>OAuth setup (only for list auto-add):</b><br/>
          1) Create a Trakt API App: <span class="mono">Settings → Your API Apps</span><br/>
          2) Redirect URI: <span class="mono">urn:ietf:wg:oauth:2.0:oob</span><br/>
          3) Click <b>Open Trakt Auth</b>, authorize, then paste the code below.
        </div>

        <div class="grid3" style="margin-top:12px">
          <div class="row">
            <button class="small" id="traktOpenAuth"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M10.5 13.5l3-3" stroke="rgba(255,255,255,.9)" stroke-width="2" stroke-linecap="round"/><path d="M7.5 16.5l-1.7 1.7a3 3 0 0 1-4.2-4.2L3.3 12.3a3 3 0 0 1 4.2 0" stroke="rgba(255,255,255,.75)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M16.5 7.5l1.7-1.7a3 3 0 1 1 4.2 4.2l-1.7 1.7a3 3 0 0 1-4.2 0" stroke="rgba(255,255,255,.75)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg><span>Open Trakt Auth</span></button>
          </div>
          <div>
            <label>Authorization Code (paste from Trakt)</label>
            <input id="traktAuthCode" placeholder="Paste code here"/>
          </div>
          <div class="row">
            <button class="small" id="traktCheckAuth"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 3 21 8v8l-9 5-9-5V8l9-5Z" stroke="rgba(255,255,255,.78)" stroke-width="1.7" stroke-linejoin="round"/><path d="M9.5 12l1.7 1.7L15.5 9.4" stroke="rgba(255,255,255,.9)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><span>Check Auth</span></button>
          </div>
        </div>

        <div class="grid3" style="margin-top:12px">
          <div>
            <label>Select list</label>
            <select id="traktList"></select>
          </div>
          <div>
            <label>Auto add to Trakt list</label>
            <select id="traktAutoAdd">
              <option value="false">Disabled</option>
              <option value="true">Enabled</option>
            </select>
            <div class="muted2" style="margin-top:6px">
              When enabled, every successful add to Radarr/Sonarr will also be added to the selected list.
            </div>
          </div>
          <div class="muted2">
            Tip: create a list like “Needs review” and use it as your audit queue.
          </div>
        </div>
      </div>

      <div class="footer">
        <div class="muted2">
          <b style="color:var(--text)">Built by D3lphi3r</b> — <span class="mono">contact@d3lphi3r.com</span>
        </div>
        <div class="muted2">v<span id="ver">—</span></div>
      </div>
    </div>
  </div>

  <script src="options.js"></script>
</body>
</html>
